ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, (!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end), exon_chrom_end <- `5_utr_start` -1)
#Eliminate exons that is all UTR
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, (!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end), exon_chrom_end <- `5_utr_start`)
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, exon_chrom_end[(!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end)] <- (`5_utr_start` - 1)
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, exon_chrom_end[(!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end)] <- (`5_utr_start` - 1))
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, exon_chrom_end[(!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end)] <-  1)
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(subset(ENST_protein_coding_fewer_UTRs, !is.null(`5_utr_end`) & !is.null(exon_chrom_end)), exon_chrom_end[`5_utr_end` == exon_chrom_end] <-  1)
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, exon_chrom_end[(!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end)] <- `5_utr_end` - 1)
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, exon_chrom_end[(!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end)] <- `5_utr_end` - 1)
#Eliminate exons that is all UTR
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, exon_chrom_end[(!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end)] <- `5_utr_end` - 1)
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- within(ENST_protein_coding_fewer_UTRs, exon_chrom_end[!is.null(`5_utr_end`) & !is.null(exon_chrom_end) & `5_utr_end` == exon_chrom_end] <- `5_utr_end` - 1)
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(is.null(x['5_utr_end'])==F &
is.null(x['exon_chrom_end'] &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(is.null(x['5_utr_end'])==F &
is.null(x['exon_chrom_end'] &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
})
}
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(is.null(x['5_utr_end'])==F &
is.null(x['exon_chrom_end']) &
(x['5_utr_end'] == x['exon_chrom_end']{
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
})
}
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(is.null(x['5_utr_end'])==F &
is.null(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
}
}
apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(is.null(x['5_utr_end'])==F &
is.null(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
}
}
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(is.null(x['5_utr_end'])==F &
is.null(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(is.null(x['5_utr_end'])==F &
is.null(x['exon_chrom_end'])==F &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(is.null(x['5_utr_end'])==FALSE &
is.null(x['exon_chrom_end'])==FALSE &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_end']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
#Eliminate exons that is all UTR
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['3_utr_start'] == x['exon_chrom_start']){
return(x['3_utr_end']-1)
} else {
return(x['exon_chrom_start'])
}
})
#Eliminate exons that is all UTR
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['3_utr_start'] == x['exon_chrom_start']){
return(x['3_utr_end']-1)
} else {
return(x['exon_chrom_start'])
}
})
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['3_utr_start'] == x['exon_chrom_start']){
return(x['3_utr_end']-1)
} else {
return(x['exon_chrom_start'])
}
})
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_start <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['3_utr_start'] == x['exon_chrom_start']){
return(x['3_utr_end']-1)
} else {
return(x['exon_chrom_start'])
}
})
#Eliminate exons that is all UTR
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_start <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['5_utr_start'] == x['exon_chrom_start']){
return(x['5_utr_end'] + 1)
} else {
return(x['exon_chrom_start'])
}
})
#Eliminate exons that is all UTR
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_start <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['5_utr_start'] == x['exon_chrom_start']){
return(x['5_utr_end']+1)
} else {
return(x['exon_chrom_start'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['3_utr_end'] == x['exon_chrom_end']){
return(x['3_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_start <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['3_utr_start'] == x['exon_chrom_start']){
return(x['3_utr_end']+1)
} else {
return(x['exon_chrom_start'])
}
})
ENST_protein_coding_fewer_UTRs[1:3]
ENST_protein_coding_fewer_UTRs[1:3][order(chromosome_name, exon_chromosome_start),]
ENST_protein_coding_no_UTRs_bed <- ENST_protein_coding_fewer_UTRs[1:3]
ENST_protein_coding_no_UTRs_bed[order(chromosome_name, exon_chromosome_start),]
ENST_protein_coding_no_UTRs_bed[order(ENST_protein_coding_no_UTRs_bed$chromosome_name, ENST_protein_coding_no_UTRs_bed$exon_chromosome_start),]
ENST_protein_coding_no_UTRs_bed[order(1, 2),]
ENST_protein_coding_no_UTRs_bed[order(2, 3),]
ENST_protein_coding_no_UTRs_bed[order(2, 3),]
View(ENST_protein_coding_UTRs)
View(ENST_protein_coding_no_UTRs_bed)
ENST_protein_coding_fewer_UTRs[1:3][
with(ENST_protein_coding_fewer_UTRs[1:3], order("chromosome_name", "exon_chrom_start"))]
ENST_protein_coding_no_UTRs_bed <- ENST_protein_coding_fewer_UTRs[1:3]
with(ENST_protein_coding_no_UTRs_bed, order("chromosome_name", "exon_chrom_start"))]
with(ENST_protein_coding_no_UTRs_bed, order("chromosome_name", "exon_chrom_start"))ENST_protein_coding_no_UTRs_bed[with(ENST_protein_coding_no_UTRs_bed, order("chromosome_name", "exon_chrom_start"))]clear
ENST_protein_coding_no_UTRs_bed[with(ENST_protein_coding_no_UTRs_bed, order("chromosome_name", "exon_chrom_start"))]
ENST_protein_coding_no_UTRs_bed <- ENST_protein_coding_no_UTRs_bed[
with(ENST_protein_coding_no_UTRs_bed, order("chromosome_name", "exon_chrom_start")
)
]
#Eliminate exons that is all UTR
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_start <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['5_utr_start'] == x['exon_chrom_start']){
return(x['5_utr_end']+1)
} else {
return(x['exon_chrom_start'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['3_utr_end'] == x['exon_chrom_end']){
return(x['3_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_start <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['3_utr_start'] == x['exon_chrom_start']){
return(x['3_utr_end']+1)
} else {
return(x['exon_chrom_start'])
}
})
ENST_protein_coding_no_UTRs_bed <- ENST_protein_coding_fewer_UTRs[1:3]
ENST_protein_coding_no_UTRs_bed <- ENST_protein_coding_no_UTRs_bed[
order(ENST_protein_coding_no_UTRs_bed$chromosome_name, ENST_protein_coding_no_UTRs_bed$exon_chrom_start)
)]
ENST_protein_coding_no_UTRs_bed <- ENST_protein_coding_no_UTRs_bed[
order(ENST_protein_coding_no_UTRs_bed$chromosome_name, ENST_protein_coding_no_UTRs_bed$exon_chrom_start)
]
ENST_protein_coding_no_UTRs_bed <- ENST_protein_coding_no_UTRs_bed[
order('chromosome_name', 'exon_chrom_start')
]
ENST_protein_coding_no_UTRs_bed <- sort(ENST_protein_coding_no_UTRs_bed$chromosome_name)
#Eliminate exons that is all UTR
ENST_protein_coding_fewer_UTRs <- ENST_protein_coding_UTRs[-which((ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`5_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`5_utr_end`) |
(ENST_protein_coding_UTRs$exon_chrom_end == ENST_protein_coding_UTRs$`3_utr_start` &
ENST_protein_coding_UTRs$exon_chrom_start == ENST_protein_coding_UTRs$`3_utr_end`)
),
]
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['5_utr_end'] == x['exon_chrom_end']){
return(x['5_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_start <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['5_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['5_utr_start'] == x['exon_chrom_start']){
return(x['5_utr_end']+1)
} else {
return(x['exon_chrom_start'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_end <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_end']) &
!is.na(x['exon_chrom_end']) &
x['3_utr_end'] == x['exon_chrom_end']){
return(x['3_utr_start']-1)
} else {
return(x['exon_chrom_end'])
}
})
ENST_protein_coding_fewer_UTRs$exon_chrom_start <- apply(ENST_protein_coding_fewer_UTRs, 1, function(x){
if(!is.na(x['3_utr_start']) &
!is.na(x['exon_chrom_start']) &
x['3_utr_start'] == x['exon_chrom_start']){
return(x['3_utr_end']+1)
} else {
return(x['exon_chrom_start'])
}
})
ENST_protein_coding_no_UTRs_bed <- ENST_protein_coding_fewer_UTRs[1:3]
sort(ENST_protein_coding_no_UTRs_bed$chromosome_name)
order(ENST_protein_coding_no_UTRs_bed$chromosome_name)
ENST_protein_coding_no_UTRs_bed[with(
ENST_protein_coding_no_UTRs_bed, order('chromosome_name', 'exon_chrom_start')), ]
ENST_protein_coding_no_UTRs_bed[with(
ENST_protein_coding_no_UTRs_bed, order('chromosome_name', 'exon_chrom_start')), ]
ENST_protein_coding_no_UTRs_bed_ordered <- ENST_protein_coding_no_UTRs_bed[with(
ENST_protein_coding_no_UTRs_bed, order('chromosome_name', 'exon_chrom_start')), ]
View(ENST_protein_coding_no_UTRs_bed_ordered)
ENST_protein_coding_no_UTRs_bed_ordered <- ENST_protein_coding_no_UTRs_bed[with(
ENST_protein_coding_no_UTRs_bed, order(chromosome_name, exon_chrom_start)), ]
View(ENST_protein_coding_no_UTRs_bed_ordered)
bedr.merge.region(ENST_protein_coding_no_UTRs_bed_ordered)
View(ENST_protein_coding_no_UTRs_bed_ordered)
View(ENST_protein_coding_no_UTRs_bed_ordered)
bedr.merge.region(ENST_protein_coding_no_UTRs_bed_ordered)
ENST_protein_coding_no_UTRs_bed_merged <- if (check.binary("bedtools")) {
index <- ENST_protein_coding_no_UTRs_bed_ordered;
a <- index[[1]];
a.merged <- bedr.merge.region(a);
}
install.packages(bedf)
install.packages(bedr)
install.packages('bedr')
install.packages("bedr")
library(bedr)
ENST_protein_coding_no_UTRs_bed_merged <- if (check.binary("bedtools")) {
index <- ENST_protein_coding_no_UTRs_bed_ordered;
a <- index[[1]];
a.merged <- bedr.merge.region(a);
}
if (check.binary("bedtools")) {
index <- get.example.regions();
a <- index[[1]];
a.sort <- bedr.sort.region(a);
a.merged <- bedr.merge.region(a.sort);
}
if (check.binary("bedr")) {
index <- get.example.regions();
a <- index[[1]];
a.sort <- bedr.sort.region(a);
a.merged <- bedr.merge.region(a.sort);
}
install.packages('bedr')
install.packages("bedr")
ENST_protein_coding_no_UTRs_bed_merged <- if (check.binary("bedtools")) {
index <- ENST_protein_coding_no_UTRs_bed_ordered;
a <- index[[1]];
a.sort <- bedr.sort.region(a);
a.merged <- bedr.merge.region(a.sort);
}
library('bedr')
ENST_protein_coding_no_UTRs_bed_merged <- if (check.binary("bedtools")) {
index <- ENST_protein_coding_no_UTRs_bed_ordered;
a <- index[[1]];
a.sort <- bedr.sort.region(a);
a.merged <- bedr.merge.region(a.sort);
}
